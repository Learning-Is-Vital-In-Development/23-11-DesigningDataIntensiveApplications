# 복제 part.2 (리더 없는 복제)

일부 데이터 저장소 시스템은 리더의 개념을 버리고 모든 복제 서버가 클라이언트로부터 쓰기를 직접 받을 수 있게 허용하는 접근 방식을 사용하기도 한다. 리악, 카산드라, 볼드모트는 다이나모에서 영감을 얻은 리더 없는 복제 모델의 오픈소스 데이터스터다. 이런 종류의 데이터베이스를 다이나모 스타일이라 한다.

여기서 다이나모는 AWS 가 제공하는 다이나모DB 와는 완전히 다르다.

## 노드가 다운됐을 때 데이터베이스에 쓰기

세 개의 복제 서버를 가진 데이터베이스가 있고 복제 서버 중 하나를 사용할 수 없다고 가정해보자. 리더 기반 설정에서 쓰기 처리를 계속하려면 장애 복구를 실행해야 한다.

반면 리더 없는 설정에서는 장애 복구가 필요하지 않다. 클라이언트는 쓰기를 세 개의 모든 복제 서버에 병렬로 전송한다. 사용 가능한 두 개의 복제 서버는 쓰기를 받았지만 사용 불가능한 복제 서버는 쓰기를 놓쳤다. 클라이언트는 복제 서버 중 하나가 쓰기를 놓친 사실을 단순히 무시한다.

이제 사용할 수 없었던 노드가 다시 온라인 상태가 되고 클라이언트가 이 노드에서 읽기를 시작한다고 생각해보자. 노드가 다운된 동안 발생한 모든 쓰기는 해당 노드에서 누락됐다. 따라서 클라이언트는 해당 노드에서 데이터를 읽는다면 응답으로 오래된(outdated) 값을 얻을 수 있다.

이 문제를 해결하기 위해 클라이언트가 데이터베이스에서 읽을 때 하나의 복제 서버로 요청을 보내지 않고 **읽기 요청을 병렬로 여러 노드에 전송**한다. 그러면 클라이언트는 여러 노드에서 다른 응답을 받을 수 있는데 이때 버전 숫자를 사용해 어떤 값이 최신 내용인지 결정한다.

### 읽기 복구와 안티 엔트로피

## 정족수 일관성의 한계

## 느슨한 정족수와 암시된 핸드오프

## 동시 쓰기 감지
